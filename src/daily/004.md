Rust Result 和 Option 方法快速记忆指南

掌握 Rust 中 Result 和 Option 的方法可以通过以下几个记忆技巧：

1. 按功能分类记忆

解包类 (Unwrapping)

• unwrap 系列：强制解包，失败时 panic

  ◦ unwrap() - 基础版

  ◦ unwrap_or() - 提供默认值

  ◦ unwrap_or_else() - 提供闭包计算默认值

  ◦ expect() - 带错误消息

• 记忆口诀："unwrap 解包装，or 给备胎，else 现计算，expect 留遗言"

转换类 (Transformation)

• map 系列：值转换

  ◦ map() - 转换值

  ◦ map_or() - 转换或给默认值

  ◦ map_or_else() - 转换或用闭包计算默认值

• 记忆口诀："map 变变变，or 有备胎，else 现做来"

链式操作 (Chaining)

• and 系列：成功时继续

  ◦ and() - 直接给值

  ◦ and_then() - 通过函数

• or 系列：失败时处理

  ◦ or() - 直接给值

  ◦ or_else() - 通过函数

• 记忆口诀："and 成功走，or 失败救，then 要函数，else 闭包凑"

2. 对称性记忆

Result 和 Option 的方法大多对称：

功能	Result	Option
成功解包	unwrap()	unwrap()
失败处理	unwrap_or()	unwrap_or()
值转换	map()	map()
链式成功	and_then()	and_then()
链式失败	or_else()	or_else()
类型转换	ok()/err()	ok_or()

3. 命名规律记忆

• 带 _or_ 的方法都提供备选方案

• 带 _else_ 的方法都用闭包计算

• 带 _then_ 的方法都接受返回相同类型的函数

• 带 _err_ 的方法都处理错误情况

4. 实用场景记忆

记住几个常用模式：

1. 安全解包：unwrap_or_else() + 错误处理

2. 链式调用：and_then() 连接多个可能失败的操作

3. 转换值：map() 保持容器类型只变内部值

4. 错误转换：map_err() 将一种错误转为另一种

5. 对比记忆表格

操作目的	Result 方法	Option 方法	记忆点
解包	unwrap()	unwrap()	相同
带默认值解包	unwrap_or()	unwrap_or()	相同
转换值	map()	map()	相同
链式操作	and_then()	and_then()	相同
错误处理	or_else()	or_else()	相同
转 Option	ok()/err()	-	Result 特有
转 Result	-	ok_or()	Option 特有
错误转换	map_err()	-	Result 特有
过滤	-	filter()	Option 特有

6. 实战记忆法

通过实际代码模式记忆：

// 安全解包模式
let value = result.unwrap_or_else(|e| {
    log_error(e);
    default_value
});

// 链式调用模式
let result = function1()
    .and_then(|x| function2(x))
    .map_err(|e| CustomError::new(e));

// 转换模式
let opt_length = some_string.map(|s| s.len());


记住这些模式比单独记忆每个方法更有效。